{% extends "base.html.twig" %}
{% block body %}
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

    <script src="//code.highcharts.com/4.1.8/highcharts.js"></script>
    <script src="//code.highcharts.com/4.1.8/modules/exporting.js"></script>

    <script>
        function getData() {
            $.ajax({
                url: "/graph/{{ id }}",
                success: function (data) {
                    chart(data)
                }
            });
        }
    </script>
    <script>setInterval(getData(), 1000)</script>
    <script type="text/javascript">
        function chart(graph) {
            $(function () {
                var linechart = new Highcharts.Chart({
                    chart: {
                        "renderTo": "linechart",
                        "events": {
                            "load": {
                                series: [{"name": "Min", "data": graph.min.split(",").map(Number)}, {
                                    "name": "Max",
                                    "data": graph.max.split(",").map(Number)
                                }, {"name": "Current", "data": graph.current.split(",").map(Number)}]
                            }
                        }
                    },
                    series: [{"name": "Min", "data": graph.min.split(",").map(Number)}, {
                        "name": "Max",
                        "data": graph.max.split(",").map(Number)
                    }, {"name": "Current", "data": graph.current.split(",").map(Number)}],
                    title: {"text": "Chart Title"},
                    xAxis: {"title": {"text": "Time"}},
                    yAxis: {"title": {"text": "Temperature"}}
                });
            })
        }
    </script>


    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h1>{{ name }} {% if icon is defined %} <img src="{{ icon }}"> {% endif %}</h1>
                <div id="result"></div>
                <div id="linechart" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
            </div>
            <div class="col-md-offset-1 col-md-7">


                <h3>Last 10 Values</h3>
                <table class="table">
                    <th>Min</th>
                    <th>Max</th>
                    <th>Current</th>
                    <th>humidity</th>
                    <th>Wind Speed</th>
                    {% for temp in temperatures %}
                        <tr>
                            <td>{{ temp.min }}</td>
                            <td>{{ temp.max }}</td>
                            <td>{{ temp.currentTemp }}</td>
                            <td>{{ temp.humidity }}</td>
                            <td>{{ temp.windSpeed }}</td>
                        </tr>
                    {% endfor %}
                </table>

            </div>
        </div>
    </div>
{% endblock %}